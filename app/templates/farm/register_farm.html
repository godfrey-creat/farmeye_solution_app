{% extends "base.html" %}

{% block title %}Farm Registration System{% endblock %}

{% block styles %}
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    .tooltip {
        position: relative;
        display: inline-block;
    }
    .tooltip .tooltip-text {
        visibility: hidden;
        width: 200px;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        transform: translateX(-50%);
        opacity: 0;
        transition: opacity 0.3s;
    }
    .tooltip:hover .tooltip-text {
        visibility: visible;
        opacity: 1;
    }
    .animate-pulse {
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }
    .map-preview {
        height: 150px;
        background-color: #e5e7eb;
        background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2U1ZTdlYiIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
        position: relative;
    }
    .marker {
        position: absolute;
        width: 12px;
        height: 12px;
        background-color: #3b82f6;
        border-radius: 50%;
        transform: translate(-50%, -50%);
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <header class="bg-white shadow rounded-lg p-6 mb-8">
        <div class="flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-green-800">Farm Registration</h1>
                <p class="text-gray-600">Register your farms, fields, and team members</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <p class="font-medium">{{ current_user.firstname }}</p>
                    <p class="text-sm text-gray-500">{{ current_user.email }}</p>
                </div>
                <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center">
                    <i class="fas fa-user text-green-600"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <form method="POST" action="{{ url_for('farm.create_farm') }}" id="farm-registration-form">
        {{ form.hidden_tag() }}
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Farm Manager Info -->
            <div class="lg:col-span-1">
                <div class="bg-white shadow rounded-lg p-6 sticky top-4">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Farm Manager Information</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">First Name</label>
                            <div class="mt-1 p-2 bg-gray-50 rounded-md border border-gray-200">{{ current_user.firstname }}</div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Last Name</label>
                            <div class="mt-1 p-2 bg-gray-50 rounded-md border border-gray-200">{{ current_user.lastname }}</div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Email</label>
                            <div class="mt-1 p-2 bg-gray-50 rounded-md border border-gray-200">{{ current_user.email }}</div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Region</label>
                            <div class="mt-1 p-2 bg-gray-50 rounded-md border border-gray-200">{{ current_user.region }}</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registration Forms -->
            <div class="lg:col-span-2">
                <!-- Team Members Section -->
                <div class="bg-white shadow rounded-lg p-6 mb-8">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">Team Members</h2>
                        <button type="button" id="add-team-member" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i> Add Member
                        </button>
                    </div>
                    
                    <div id="teamMembers" class="space-y-4">
                        <!-- Team member rows will be added here -->
                    </div>
                </div>

                <!-- Farms Section -->
                <div class="bg-white shadow rounded-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">Farms</h2>
                        <button type="button" id="add-farm" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i> Add Farm
                        </button>
                    </div>
                    
                    <div id="farms" class="space-y-6">
                        <!-- Farm sections will be added here -->
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="mt-8 text-right">
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-md font-medium text-lg flex items-center mx-auto">
                        <i class="fas fa-check-circle mr-2"></i> Complete Registration
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/farm_registration.js') }}"></script>
{% endblock %}